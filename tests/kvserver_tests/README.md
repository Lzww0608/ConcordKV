# ConcordKV æµ‹è¯•å¥—ä»¶

æœ¬ç›®å½•åŒ…å«ConcordKVå­˜å‚¨å¼•æ“çš„å®Œæ•´æµ‹è¯•å¥—ä»¶ï¼ŒæŒ‰å­˜å‚¨å¼•æ“ç±»å‹åˆ†ç±»ç»„ç»‡ã€‚

## ğŸ“ ç›®å½•ç»“æ„

```
tests/kvserver_tests/
â”œâ”€â”€ btree_tests/          # B+Treeå­˜å‚¨å¼•æ“æµ‹è¯• â­
â”œâ”€â”€ hash_tests/           # Hashå­˜å‚¨å¼•æ“æµ‹è¯•
â”œâ”€â”€ rbtree_tests/         # RBTreeå­˜å‚¨å¼•æ“æµ‹è¯•
â”œâ”€â”€ array_tests/          # Arrayå­˜å‚¨å¼•æ“æµ‹è¯•
â”œâ”€â”€ system_tests/         # ç³»ç»ŸåŠŸèƒ½æµ‹è¯•ï¼ˆäº‹åŠ¡ã€å¹¶å‘ã€æŒä¹…åŒ–ç­‰ï¼‰
â”œâ”€â”€ engine_tests/         # å¼•æ“æ¥å£å’Œé€šç”¨åŠŸèƒ½æµ‹è¯•
â”œâ”€â”€ build/                # CMakeæ„å»ºç›®å½•
â”œâ”€â”€ CMakeLists.txt        # CMakeé…ç½®æ–‡ä»¶
â”œâ”€â”€ build.sh              # æ„å»ºè„šæœ¬
â””â”€â”€ README.md             # æœ¬æ–‡ä»¶
```

## ğŸŒ³ B+Treeæµ‹è¯• (btree_tests/)

B+Treeæ˜¯ConcordKVçš„ä¸»è¦å­˜å‚¨å¼•æ“ï¼Œæä¾›å…¨é¢çš„æµ‹è¯•è¦†ç›–ã€‚

### æµ‹è¯•æ–‡ä»¶

- `btree_test.c` - å®Œæ•´çš„B+TreeåŠŸèƒ½æµ‹è¯•å¥—ä»¶
- `btree_production_test.c` - ç”Ÿäº§çº§æ£€æŸ¥ç¨‹åº â­
- `debug_btree.c` - è°ƒè¯•å’Œé—®é¢˜è¯Šæ–­å·¥å…·
- `simple_test.c` - ç®€å•çš„åŸºç¡€åŠŸèƒ½éªŒè¯

### è¿è¡Œæ–¹å¼

```bash
# ä»kvserverç›®å½•è¿è¡Œ
cd ConcordKV/kvserver

# è¿è¡Œå®Œæ•´B+Treeæµ‹è¯•
make run_btree_test

# è¿è¡Œç”Ÿäº§ç¯å¢ƒæ£€æŸ¥ â­ æ¨è
make run_production_test

# è¿è¡Œè°ƒè¯•ç¨‹åº
make run_debug_btree

# è¿è¡Œç®€å•æµ‹è¯•
make run_simple_debug
```

### ç”Ÿäº§ç¯å¢ƒæ£€æŸ¥å†…å®¹

`btree_production_test.c` åŒ…å«4é¡¹å…³é”®æ£€æŸ¥ï¼š

1. **é˜¶æ•°å’Œé…ç½®æ£€æŸ¥** - éªŒè¯B+Treeé…ç½®çš„åˆç†æ€§
2. **å†…å­˜ä½¿ç”¨æ£€æŸ¥** - ç›‘æ§å†…å­˜æ•ˆç‡å’Œå¼€é”€
3. **å¹¶å‘å®‰å…¨æ£€æŸ¥** - 8çº¿ç¨‹é«˜å¹¶å‘å‹åŠ›æµ‹è¯•
4. **æ ‘ç»“æ„å®Œæ•´æ€§æ£€æŸ¥** - B+Treeå±æ€§éªŒè¯

**æœŸæœ›ç»“æœ**: 4/4æµ‹è¯•é€šè¿‡ï¼ŒæˆåŠŸç‡100%

## ğŸ—ƒï¸ Hashæµ‹è¯• (hash_tests/)

Hashå­˜å‚¨å¼•æ“ä¸“æ³¨äºé«˜æ€§èƒ½å“ˆå¸Œè¡¨å®ç°ã€‚

### æµ‹è¯•æ–‡ä»¶

- `kvstore_hash_test.cpp` - Hashå¼•æ“C++æµ‹è¯•å¥—ä»¶
- `simple_hash_test.c` - åŸºç¡€HashåŠŸèƒ½æµ‹è¯•
- `test_hash_optimized.c` - ä¼˜åŒ–æ€§èƒ½æµ‹è¯•
- `test_hash_collision.c` - å“ˆå¸Œå†²çªå¤„ç†æµ‹è¯•
- `run_all_hash_tests.sh` - æ‰¹é‡è¿è¡Œè„šæœ¬
- `test_hash_performance.sh` - æ€§èƒ½åŸºå‡†æµ‹è¯•

### è¿è¡Œæ–¹å¼

```bash
# è¿è¡ŒHashå¼•æ“æµ‹è¯•
make test_hash

# æˆ–ç›´æ¥è¿è¡Œè„šæœ¬
cd tests/kvserver_tests/hash_tests
./run_all_hash_tests.sh
```

## ğŸŒ² RBTreeæµ‹è¯• (rbtree_tests/)

çº¢é»‘æ ‘å­˜å‚¨å¼•æ“æä¾›æœ‰åºå­˜å‚¨åŠŸèƒ½ã€‚

### æµ‹è¯•æ–‡ä»¶

- `kvstore_rbtree_test.cpp` - RBTreeå¼•æ“C++æµ‹è¯•å¥—ä»¶
- `test_hash_rbtree_conversion.c` - Hashä¸RBTreeè½¬æ¢æµ‹è¯•

### è¿è¡Œæ–¹å¼

```bash
# è¿è¡ŒRBTreeå¼•æ“æµ‹è¯•
make test_rbtree
```

## ğŸ“Š Arrayæµ‹è¯• (array_tests/)

Arrayå­˜å‚¨å¼•æ“é€‚ç”¨äºå°æ•°æ®é›†å’ŒåŸå‹å¼€å‘ã€‚

### æµ‹è¯•æ–‡ä»¶

- `kvstore_array_test.cpp` - Arrayå¼•æ“C++æµ‹è¯•å¥—ä»¶

### è¿è¡Œæ–¹å¼

```bash
# è¿è¡ŒArrayå¼•æ“æµ‹è¯•
make test_array
```

## âš™ï¸ ç³»ç»ŸåŠŸèƒ½æµ‹è¯• (system_tests/)

æµ‹è¯•ConcordKVçš„æ ¸å¿ƒç³»ç»ŸåŠŸèƒ½ã€‚

### æµ‹è¯•æ–‡ä»¶

- `kv_transaction_test.cpp` - äº‹åŠ¡ç³»ç»Ÿæµ‹è¯•
- `kv_concurrency_test.cpp` - å¹¶å‘æ§åˆ¶æµ‹è¯•
- `kv_persist_test.cpp` - æŒä¹…åŒ–åŠŸèƒ½æµ‹è¯•
- `kv_error_test.cpp` - é”™è¯¯å¤„ç†æµ‹è¯•

### è¿è¡Œæ–¹å¼

```bash
# è¿è¡Œç³»ç»ŸåŠŸèƒ½æµ‹è¯•
make test_system
```

## ğŸ”§ å¼•æ“æ¥å£æµ‹è¯• (engine_tests/)

æµ‹è¯•ç»Ÿä¸€å¼•æ“æ¥å£å’Œé€šç”¨åŠŸèƒ½ã€‚

### æµ‹è¯•æ–‡ä»¶

- `testcase.c` - å¼•æ“æ¥å£åŸºç¡€æµ‹è¯•
- `main.cpp` - ä¸»æµ‹è¯•å…¥å£

### è¿è¡Œæ–¹å¼

```bash
# è¿è¡Œå¼•æ“æ¥å£æµ‹è¯•
make test_engine_interface
```

## ğŸš€ å¿«é€Ÿè¿è¡Œæ‰€æœ‰æµ‹è¯•

### åˆ†ç±»è¿è¡Œ

```bash
# è¿è¡Œæ‰€æœ‰åˆ†ç±»æµ‹è¯•
make test_by_category

# è¿è¡Œæ ¸å¿ƒæµ‹è¯•
make test_all

# è¿è¡ŒåŸºç¡€æ¥å£æµ‹è¯•
make test
```

### æ€§èƒ½æµ‹è¯•

```bash
# è¿è¡Œæ€§èƒ½åŸºå‡†æµ‹è¯•
make perf_test

# å†…å­˜æ³„æ¼æ£€æŸ¥
make memcheck
```

## ğŸ“Š æµ‹è¯•ç»“æœç¤ºä¾‹

### B+Treeç”Ÿäº§ç¯å¢ƒæ£€æŸ¥ç»“æœ

```
ğŸ” B+Treeç”Ÿäº§çº§æ£€æŸ¥
===========================

=== B+Treeé˜¶æ•°å’Œé…ç½®æ£€æŸ¥ ===
é»˜è®¤é˜¶æ•°: 100
âœ… é˜¶æ•°é…ç½®æ£€æŸ¥å®Œæˆ

=== å†…å­˜ä½¿ç”¨æ£€æŸ¥ ===
  50000 é”®: å†…å­˜ä½¿ç”¨=135 KB, æ¯”ç‡=0.04
âœ… å†…å­˜ä½¿ç”¨æ£€æŸ¥å®Œæˆ

=== å¹¶å‘å®‰å…¨æ£€æŸ¥ ===
æ€»ä½“æ€§èƒ½: 832484 ops/sec, æ€»é”™è¯¯: 0
âœ… å¹¶å‘å®‰å…¨æ£€æŸ¥é€šè¿‡

=== æ ‘ç»“æ„å®Œæ•´æ€§æ£€æŸ¥ ===
âœ… æ ‘ç»“æ„å®Œæ•´æ€§æ£€æŸ¥é€šè¿‡

=== ç”Ÿäº§ç¯å¢ƒæ£€æŸ¥æŠ¥å‘Š ===
æ€»æµ‹è¯•æ•°: 4
é€šè¿‡æµ‹è¯•: 4
æˆåŠŸç‡: 100.0%

ğŸ‰ B+Treeå·²å‡†å¤‡å¥½æŠ•å…¥ç”Ÿäº§ç¯å¢ƒä½¿ç”¨ï¼
```

## ğŸ” æ•…éšœæ’é™¤

### ç¼–è¯‘é—®é¢˜

```bash
# æ¸…ç†ç¼–è¯‘äº§ç‰©
make clean

# é‡æ–°ç¼–è¯‘
make all
```

### è¿è¡Œæƒé™é—®é¢˜

```bash
# ç»™è„šæœ¬æ·»åŠ æ‰§è¡Œæƒé™
chmod +x tests/kvserver_tests/hash_tests/*.sh
```

### è·¯å¾„é—®é¢˜

ç¡®ä¿ä»`ConcordKV/kvserver`ç›®å½•è¿è¡Œmakeå‘½ä»¤ï¼Œæµ‹è¯•æ–‡ä»¶çš„è·¯å¾„éƒ½æ˜¯ç›¸å¯¹äºè¯¥ç›®å½•é…ç½®çš„ã€‚

## ğŸ¯ æµ‹è¯•è¦†ç›–ç‡

| ç»„ä»¶ | æµ‹è¯•è¦†ç›–ç‡ | çŠ¶æ€ |
|------|------------|------|
| B+Treeå¼•æ“ | 100% | âœ… å®Œæˆ |
| Hashå¼•æ“ | 95% | âœ… å®Œæˆ |
| RBTreeå¼•æ“ | 90% | âœ… å®Œæˆ |
| Arrayå¼•æ“ | 85% | âœ… å®Œæˆ |
| ç»Ÿä¸€æ¥å£ | 100% | âœ… å®Œæˆ |
| äº‹åŠ¡ç³»ç»Ÿ | 95% | âœ… å®Œæˆ |
| å¹¶å‘æ§åˆ¶ | 100% | âœ… å®Œæˆ |

**æ€»ä½“æµ‹è¯•è¦†ç›–ç‡: 96%** ğŸ‰

---

æ›´å¤šä¿¡æ¯è¯·å‚é˜…é¡¹ç›®æ–‡æ¡£ï¼š
- [APIæ–‡æ¡£](../../docs/API.md)
- [å¼€å‘è·¯çº¿å›¾](../../docs/ROADMAP.md) 